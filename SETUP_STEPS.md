# Пошаговая настройка бота

## Шаг 1: Узнать свой Telegram ID

1. Откройте [@userinfobot](https://t.me/userinfobot)
2. Отправьте любое сообщение
3. Бот покажет ваш ID (например: `123456789`)
4. **Скопируйте этот ID** — он понадобится для `ADMIN_IDS`

## Шаг 2: Создать каналы

### 2.1. Промежуточный канал для модерации

1. Создайте новый канал в Telegram (например: "Модерация новостей")
2. Добавьте бота `@maincomby_bot` как администратора:
   - Настройки канала → Администраторы → Добавить администратора
   - Найдите `@maincomby_bot`
   - Выдайте права:
     - ✅ Публиковать сообщения
     - ✅ Редактировать сообщения
     - ✅ Удалять сообщения
3. Узнайте ID канала:
   - Добавьте [@userinfobot](https://t.me/userinfobot) в канал
   - Или перешлите сообщение из канала боту [@getidsbot](https://t.me/getidsbot)
   - ID канала будет в формате `-1001234567890` (отрицательное число)
   - **Скопируйте этот ID** — это будет `INTERMEDIATE_CHAT_ID`

### 2.2. Основной канал для публикации

1. Создайте основной канал (или используйте существующий)
2. Добавьте бота `@maincomby_bot` как администратора:
   - Настройки канала → Администраторы → Добавить администратора
   - Найдите `@maincomby_bot`
   - Выдайте права:
     - ✅ Публиковать сообщения
     - ✅ Редактировать сообщения
3. Узнайте ID канала (аналогично шагу 2.1)
   - **Скопируйте этот ID** — это будет `TARGET_CHANNEL_ID`

## Шаг 3: Обновить .env файл

Откройте файл `.env` и обновите следующие значения:

```bash
# Ваш Telegram ID (из шага 1)
ADMIN_IDS=ваш_telegram_id_здесь

# ID промежуточного канала для модерации (из шага 2.1)
INTERMEDIATE_CHAT_ID=-1001234567890

# ID основного канала для публикации (из шага 2.2)
TARGET_CHANNEL_ID=-1001234567890
```

**Важно:** Раскомментируйте строки (уберите `#` в начале), если они закомментированы.

## Шаг 4: Добавить бота в каналы-источники

Бот должен быть подписан на каналы-источники, чтобы получать их сообщения.

**Вариант А (если у вас есть доступ к каналам):**
- Добавьте бота `@maincomby_bot` как администратора в каждый канал-источник

**Вариант Б (если доступа нет):**
- Бот будет получать сообщения через Telegram API, если он подписан на каналы
- Для этого нужно добавить бота в каналы через интерфейс Telegram

## Шаг 5: Запустить бота

```bash
cd /Users/admin/maincomby_bot
source .venv/bin/activate  # Если используете venv
python -m app.main
```

Бот должен запуститься и показать в логах: `Starting bot long-polling…`

## Шаг 6: Добавить каналы-источники

1. Создайте группу в Telegram (или используйте существующую)
2. Добавьте бота `@maincomby_bot` в группу
3. Отправьте команду:

```
/add_default_channels
```

Эта команда добавит все 7 предустановленных каналов:
- @elkornacio
- @tips_ai
- @data_secrets
- @ii_community
- @cryptoEssay
- @lovedeathtransformers
- @ArtificialIntelligencedl

## Шаг 7: Проверить работу

1. Проверьте список каналов:
   ```
   /list_source_channels
   ```

2. Дождитесь новых постов из каналов-источников
3. Бот автоматически:
   - Получит пост
   - Адаптирует через OpenAI
   - Отправит в промежуточный канал для модерации
4. В промежуточном канале вы увидите сообщение с кнопками:
   - `/approve_<id>` — одобрить и опубликовать
   - `/reject_<id>` — отклонить

## Готово!

Бот теперь работает и будет автоматически:
- Мониторить каналы-источники
- Адаптировать новости
- Отправлять на модерацию
- Публиковать после одобрения

## Полезные команды

- `/help` — список всех команд
- `/list_pending` — посты на модерации
- `/list_source_channels` — список отслеживаемых каналов
- `/add_source_channel @channel` — добавить новый канал вручную

