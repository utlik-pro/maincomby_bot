# üõ†Ô∏è –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ VPS

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ –ø–æ–¥–Ω—è—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–∞–∑—ã.

---

## 1. –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —à–∞–≥–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–±–æ—è

1. –°–≤—è–∂–∏—Ç–µ—Å—å —Å —Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º –∏ —É—Ç–æ—á–Ω–∏—Ç–µ —Å—Ç–∞—Ç—É—Å VPS.
2. –°–¥–µ–ª–∞–π—Ç–µ –∫–æ–ø–∏—é –ª–æ–∫–∞–ª—å–Ω–æ–π `bot.db` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `cp bot.db bot.db.backup_$(date +%Y%m%d_%H%M%S)`).
3. –†–µ—à–∏—Ç–µ, –±—É–¥–µ—Ç–µ –ª–∏ —Å–æ–±–∏—Ä–∞—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω–æ ‚Äî –µ—Å–ª–∏ –¥–∞, —Å–ª–µ–¥—É–π—Ç–µ —Ä–∞–∑–¥–µ–ª—É –Ω–∏–∂–µ.

---

## 2. –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π `BOT_TOKEN` –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
bash scripts/run_local.sh
```

–°–∫—Ä–∏–ø—Ç:
- —Å–æ–∑–¥–∞—ë—Ç/–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç `venv`
- —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å `SKIP_INSTALL=1`)
- –∑–∞–ø—É—Å–∫–∞–µ—Ç `app/main.py`

3. –ß—Ç–æ–±—ã –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–∏–¥–µ—Ç—å –ª–æ–≥–∏, –¥–æ–±–∞–≤—å—Ç–µ `| tee -a local.log` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π –ø—Ä–æ—Ü–µ—Å—Å-–º–µ–Ω–µ–¥–∂–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä `honcho`, `foreman`).

---

## 3. –§–∏–∫—Å–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

- –î–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ –∏–ª–∏ —Å–æ–±—ã—Ç–∏—è —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–∞—Ç—É/ID –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ø–∏—Å–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `local_changes.md`).
- –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–æ–≤, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é `bot.db`.
- –ï—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è —Ä—É—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –≤ –±–∞–∑–µ, –≤–µ–¥–∏—Ç–µ –∂—É—Ä–Ω–∞–ª SQL-–∫–æ–º–∞–Ω–¥.

---

## 4. –°–ª–∏—è–Ω–∏–µ SQLite-–±–∞–∑ –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è VPS

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å VPS, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ—è–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø:

```bash
scp root@104.253.1.54:/root/maincomby_bot/bot.db /tmp/bot_vps.db
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dry-run, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ:

```bash
python scripts/merge_sqlite.py --source bot.db --target /tmp/bot_vps.db --dry-run
```

3. –ï—Å–ª–∏ –≤—Å—ë —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ:

```bash
python scripts/merge_sqlite.py --source bot.db --target /tmp/bot_vps.db
```

–û—Ç—á—ë—Ç –ø–æ–∫–∞–∂–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–∞–∂–¥—É—é —Ç–∞–±–ª–∏—Ü—É. –°–∫—Ä–∏–ø—Ç –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π, –∏ –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏.

4. –ó–∞–º–µ–Ω–∏—Ç–µ –±–∞–∑—É –Ω–∞ VPS –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```bash
scp /tmp/bot_vps.db root@104.253.1.54:/root/maincomby_bot/bot.db
ssh root@104.253.1.54 "cd /root/maincomby_bot && docker compose up -d --build"
```

5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ (`/help`, `/event_stats`, —Ä–∞—Å—Å—ã–ª–∫–∏).

---

## 5. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ `BACKUP_GUIDE.md` (—Å–∫—Ä–∏–ø—Ç `/root/full_backup.sh`).
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –≥—Ä–∞—Ñ–∏–∫: –º–∏–Ω–∏–º—É–º —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é + –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –∫—Ä—É–ø–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ VPS (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ UptimeRobot, Pingdom).
- –•—Ä–∞–Ω–∏—Ç–µ –∫–æ–ø–∏–∏ –±–∞–∑ –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (`gpg -c bot.db`).

---

## 6. –ß—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ

- `scripts/run_local.sh` ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ª–æ–∫–∞–ª—å–Ω–æ.
- `scripts/merge_sqlite.py` ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ë–î.
- `deploy_to_vps.sh` ‚Äî —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

---

## 7. –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –Ω–∞ VPS

1. –ï—Å—Ç—å —Å–≤–µ–∂–∏–π –±—ç–∫–∞–ø VPS (–∏–ª–∏ `full_backup_*.tar.gz` —Å–∫–∞—á–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ).
2. –í—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–º, –±–∞–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.
3. –°–ª–∏—è–Ω–∏–µ SQLite –ø—Ä–æ—à–ª–æ –±–µ–∑ –æ—à–∏–±–æ–∫ (–ø—Ä–æ–≤–µ—Ä–µ–Ω—ã counts).
4. Docker –Ω–∞ VPS –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω, –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/help`.
5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–∫–ª—é—á–µ–Ω, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –ø–∞–¥–µ–Ω–∏–∏.

---

üí° –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≤—ã–≥—Ä—É–∑–∫—É `bot.db` —Å VPS). –ü–æ–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

